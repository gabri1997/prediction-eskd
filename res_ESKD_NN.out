Job iniziato su carabbaggio
Data e ora: Fri Oct 17 23:27:12 CEST 2025
GPU disponibile: NVIDIA GeForce GTX 1080 Ti
Starting testing script...

============================================================
Evaluating Fold 1/10
============================================================
Loaded scaler for fold 1
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 1
First layer weights (sample): tensor([ 0.0807,  0.2661, -0.1129,  0.3651, -0.0809], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 1 - Accuracy: 0.9203, Precision: 0.8571, Recall: 0.6923, F1: 0.7660

============================================================
Evaluating Fold 2/10
============================================================
Loaded scaler for fold 2
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 2
First layer weights (sample): tensor([ 0.2392,  0.2339, -0.0800,  0.3003, -0.0627], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 2 - Accuracy: 0.8986, Precision: 0.7308, Recall: 0.7308, F1: 0.7308

============================================================
Evaluating Fold 3/10
============================================================
Loaded scaler for fold 3
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 3
First layer weights (sample): tensor([ 0.1516,  0.2832, -0.0730,  0.2628, -0.1566], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 3 - Accuracy: 0.8768, Precision: 0.6364, Recall: 0.8077, F1: 0.7119

============================================================
Evaluating Fold 4/10
============================================================
Loaded scaler for fold 4
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 4
First layer weights (sample): tensor([ 0.1902,  0.2419, -0.1098,  0.2536, -0.0270], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 4 - Accuracy: 0.8986, Precision: 0.7000, Recall: 0.8077, F1: 0.7500

============================================================
Evaluating Fold 5/10
============================================================
Loaded scaler for fold 5
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 5
First layer weights (sample): tensor([ 0.1865,  0.2616, -0.1131,  0.2761, -0.0568], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 5 - Accuracy: 0.8986, Precision: 0.7143, Recall: 0.7692, F1: 0.7407

============================================================
Evaluating Fold 6/10
============================================================
Loaded scaler for fold 6
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 6
First layer weights (sample): tensor([ 0.1825,  0.2647, -0.1379,  0.2431, -0.0539], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 6 - Accuracy: 0.8841, Precision: 0.6667, Recall: 0.7692, F1: 0.7143

============================================================
Evaluating Fold 7/10
============================================================
Loaded scaler for fold 7
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 7
First layer weights (sample): tensor([ 0.1713,  0.2538, -0.0598,  0.2686, -0.0796], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 7 - Accuracy: 0.8986, Precision: 0.7000, Recall: 0.8077, F1: 0.7500

============================================================
Evaluating Fold 8/10
============================================================
Loaded scaler for fold 8
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 8
First layer weights (sample): tensor([ 0.2107,  0.2317, -0.0632,  0.2682, -0.0887], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 8 - Accuracy: 0.9130, Precision: 0.7500, Recall: 0.8077, F1: 0.7778

============================================================
Evaluating Fold 9/10
============================================================
Loaded scaler for fold 9
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 9
First layer weights (sample): tensor([ 0.2306,  0.2407, -0.0707,  0.2920, -0.0910], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 9 - Accuracy: 0.9203, Precision: 0.8000, Recall: 0.7692, F1: 0.7843

============================================================
Evaluating Fold 10/10
============================================================
Loaded scaler for fold 10
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 10
First layer weights (sample): tensor([ 0.1688,  0.2233,  0.0145,  0.2553, -0.0458], device='cuda:0',
       grad_fn=<SliceBackward0>)
Evaluating on test set with dateAssess > 5 years
Fold 10 - Accuracy: 0.9058, Precision: 0.7600, Recall: 0.7308, F1: 0.7451

 Individual results saved to /work/grana_far2023_fomo/ESKD/Models_SWEEP_PARAM_ADAM_PROXYLOSS_SAMPLER_NO_ACCESS_SINGLE_SWEEP_THERAPY_CREATININE/test_results.json

============================================================
AVERAGE RESULTS ACROSS FOLDS
============================================================
{'Years Threshold': 5, 'Accuracy': '0.9014 ± 0.0134', 'Precision': '0.7315 ± 0.0610', 'Recall': '0.7692 ± 0.0385', 'F1 Score': '0.7471 ± 0.0231'}
Average results saved to /work/grana_far2023_fomo/ESKD/Models_SWEEP_PARAM_ADAM_PROXYLOSS_SAMPLER_NO_ACCESS_SINGLE_SWEEP_THERAPY_CREATININE/average_test_results_years_5.json
Job finito.
Data e ora di fine: Fri Oct 17 23:27:28 CEST 2025
GPU utilizzata: NVIDIA GeForce GTX 1080 Ti
