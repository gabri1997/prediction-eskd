Job iniziato su carabbaggio
Data e ora: Fri Oct 17 23:22:00 CEST 2025
GPU disponibile: NVIDIA GeForce GTX 1080 Ti
Starting testing script...

============================================================
Evaluating Fold 1/10
============================================================
Loaded scaler for fold 1
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 1
First layer weights (sample): tensor([ 0.0807,  0.2661, -0.1129,  0.3651, -0.0809], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 1 - Accuracy: 0.8995, Precision: 0.8529, Recall: 0.6744, F1: 0.7532

============================================================
Evaluating Fold 2/10
============================================================
Loaded scaler for fold 2
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 2
First layer weights (sample): tensor([ 0.2392,  0.2339, -0.0800,  0.3003, -0.0627], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 2 - Accuracy: 0.8783, Precision: 0.7381, Recall: 0.7209, F1: 0.7294

============================================================
Evaluating Fold 3/10
============================================================
Loaded scaler for fold 3
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 3
First layer weights (sample): tensor([ 0.1516,  0.2832, -0.0730,  0.2628, -0.1566], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 3 - Accuracy: 0.8571, Precision: 0.6600, Recall: 0.7674, F1: 0.7097

============================================================
Evaluating Fold 4/10
============================================================
Loaded scaler for fold 4
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 4
First layer weights (sample): tensor([ 0.1902,  0.2419, -0.1098,  0.2536, -0.0270], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 4 - Accuracy: 0.8730, Precision: 0.7021, Recall: 0.7674, F1: 0.7333

============================================================
Evaluating Fold 5/10
============================================================
Loaded scaler for fold 5
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 5
First layer weights (sample): tensor([ 0.1865,  0.2616, -0.1131,  0.2761, -0.0568], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 5 - Accuracy: 0.8783, Precision: 0.7273, Recall: 0.7442, F1: 0.7356

============================================================
Evaluating Fold 6/10
============================================================
Loaded scaler for fold 6
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 6
First layer weights (sample): tensor([ 0.1825,  0.2647, -0.1379,  0.2431, -0.0539], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 6 - Accuracy: 0.8730, Precision: 0.7111, Recall: 0.7442, F1: 0.7273

============================================================
Evaluating Fold 7/10
============================================================
Loaded scaler for fold 7
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 7
First layer weights (sample): tensor([ 0.1713,  0.2538, -0.0598,  0.2686, -0.0796], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 7 - Accuracy: 0.8783, Precision: 0.7174, Recall: 0.7674, F1: 0.7416

============================================================
Evaluating Fold 8/10
============================================================
Loaded scaler for fold 8
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 8
First layer weights (sample): tensor([ 0.2107,  0.2317, -0.0632,  0.2682, -0.0887], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 8 - Accuracy: 0.8836, Precision: 0.7333, Recall: 0.7674, F1: 0.7500

============================================================
Evaluating Fold 9/10
============================================================
Loaded scaler for fold 9
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 9
First layer weights (sample): tensor([ 0.2306,  0.2407, -0.0707,  0.2920, -0.0910], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 9 - Accuracy: 0.8942, Precision: 0.7805, Recall: 0.7442, F1: 0.7619

============================================================
Evaluating Fold 10/10
============================================================
Loaded scaler for fold 10
Number of samples with dateAssess > 5 years: 138
Number of samples with dateAssess > 10 years: 66
Test shape with dateAssess > 5 years: (138, 11), Labels: (138,)
Test shape with dateAssess > 10 years: (66, 11), Labels: (66,)
Test shape: (189, 11), Labels: (189,)
Test class distribution: {0: 146, 1: 43}
Loaded model for fold 10
First layer weights (sample): tensor([ 0.1688,  0.2233,  0.0145,  0.2553, -0.0458], device='cuda:0',
       grad_fn=<SliceBackward0>)
Fold 10 - Accuracy: 0.8942, Precision: 0.7949, Recall: 0.7209, F1: 0.7561

 Individual results saved to /work/grana_far2023_fomo/ESKD/Models_SWEEP_PARAM_ADAM_PROXYLOSS_SAMPLER_NO_ACCESS_SINGLE_SWEEP_THERAPY_CREATININE/test_results.json

============================================================
AVERAGE RESULTS ACROSS FOLDS
============================================================
{'Years Threshold': 0, 'Accuracy': '0.8810 ± 0.0119', 'Precision': '0.7418 ± 0.0517', 'Recall': '0.7419 ± 0.0284', 'F1 Score': '0.7398 ± 0.0151'}
Average results saved to /work/grana_far2023_fomo/ESKD/Models_SWEEP_PARAM_ADAM_PROXYLOSS_SAMPLER_NO_ACCESS_SINGLE_SWEEP_THERAPY_CREATININE/average_test_results_years_0.json
Job finito.
Data e ora di fine: Fri Oct 17 23:22:19 CEST 2025
GPU utilizzata: NVIDIA GeForce GTX 1080 Ti
